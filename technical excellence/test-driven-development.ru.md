---
title: Разработка через тестирование
order: 50
---

## Что такое Разработка через тестирование?

Разработка через тестирование (test-driven development, TDD) это стиль разработки, в котором дизайн системы определяется тестами, которые разрабатываются в следующих коротких циклах:

1. Написать один тест.
2. Написать только лишь необходимое количество кода, чтобы тест завершался успешно.
3. Провести рефакторинг кода, чтобы сделать его "чистым".

<img src="/img/technical-excellence/tdd.png" width="30%">

В языках программирования, таких как Java, такие циклы занимают не более пяти минут. В старых языках, с медленной компиляцией и меньшей поддержкой автоматизации рефакторинга, такой цикл занимает больше времени — около 20 минут.

Отличается ли чем-то разработка через тестирование для случаев крупномасштабной разработки? Нет. Это практика индивидуальной разработки, поэтому количество разработчиков в продуктовой группе не имеет значение.
Объем унаследованного кода, старых технологий, встраиваемого ПО не оказывает влияния на возможность применения модульного тестирования и TDD. Таким образом, большая часть опыта, описываемого в текущем разделе, основывается на этом.

### TDD-цикл Должен Быть ...

<dl>
<dt>Коротким</dt>
<dd>Время прохождения каждого теста мало. Весь цикл должен занимать не более 5 минут.</dd>

<dt>Ритмичным</dt>
<dd>Вы отчётливо почувствуете ритм - “красный, зелёный, рефакторинг... красный, зелёный, рефакторинг...”</dd>

<dt>Инкрементальным</dt>
<dd>Вы убедитесь, что при написании и успешном прохождении новых тестов, работающий функционал наращивается инкрементально.</dd>

<dt>Сфокусированным на дизайне</dt>
<dd>Хорошо зная принципы дизайна ПО, вы откроете для себя, что TDD это не техника тестирования, а метод проектирования ПО.</dd>

<dt>Дисциплинированным</dt>
<dd>TDD это другой подход к разработке ПО. Отказ от старой привычки "написать и исправить" ("code and fix") и внедрение новой потребуют дисциплины и упорства.</dd>
</dl>

## Почему TDD?


## Обучение TDD

### Воспользуйтесь помощью тренеров по TDD

Однажды наш клиент ознакомился с черновиком нашего предложения, и отметил, что мы должны уделить больше внимания найму дополнительных тренеров. “Одна из наших ошибок в том, что мы не достаточно времени уделяли тренингам“ - сказал он. Хотя мы с ним согласились, мы про себя отметили, что, поскольку мы тоже являлись консультантами и предоставляли подобные услуги, такой совет не заслужил бы у нас большого доверия. С тем же успехом мы могли бы предложить эксперимент: «Попробуй... Найми **нас**». Таким образом, мы уделили минимум внимания этому совету, связанному с наймом тренеров.

Но применительно к разработке через тестирование, невозможно выразить словами, насколько это важно: Наймите тренеров! Внедрение TDD означает "забывание" традиционных способов разработки и освоение заново, как проектировать и писать код. Мы редко встречаем людей, кто может научится этой практике самостоятельно. Большинство разработчиков нуждаются в парной работе с тренером в течение нескольких дней или недель. Тренер постоянно напоминает им писать тесты в первую очередь и буквально вычищать свой код — включая код тестов. Он помогает им овладеть техниками TDD и рефакторинга на их реальной кодовой базе.   

Разработка через тестирование может оказаться самой сложной гибкой практикой для внедрения, но в тоже время — это одна из самых больших возможностей для улучшения качества проектирования и кода. Наймите тренеров!

### Внутренние и внешние тренеры

Внешние тренеры необходимы для внедрения TDD, потому что данный навык ещё не привит внутри компании. Но по прошествии некоторого времени, воспитание внутренних тренеров снижает зависимость от их внешних коллег и снижает стоимость обучения.

Тем не менее, мы наблюдали, как несколько попыток в развитии внутренних тренеров провалились. Вот некоторые их причины:

* Отсутствие структурированного похода при принятии решений, кто из тренеров, когда и с какими командами будет работать.
* Отсутствие времени, запланированного на тренинги. Вместо этого тренеров просили заниматься обычно разработкой.
* Разработчики менее охотно учились у внутренних тренеров... "тяжело быть пророком на своей земле".
* Тренерские навыки не ценились и им не давали возможности развиваться. В результате опытные тренеры часто уходили, чтобы стать внешними консультантами.

Используйте как внутреннее так и внешнее обучение. Если остаётся только одно из них, это становиться рискованным. Но их комбинация может привести к хорошим результатам.

## Разработка через тестирование для создания лучшей архитектуры

TDD может помочь улучшить архитектуру системы. Как?

Когда мы работаем в качестве консультантов, наиболее частым запросом является помощь при работе с "негибкой архитектурой" наших клиентов. Чаще всего это сводится к проблемам в сильной связанности компонентов — распространённой проблеме в унаследованном коде, написанном без TDD, потому что разработчик-автор не пытался тестировать компонент изолированно.

С другой стороны, когда разработчики создают новый компонент (например, новый класс) по TDD, или производят рефакторинг унаследованного компонента для того, чтобы его можно было протестировать, они должны нарушить зависимости между этим компонентом и всеми остальными, чтобы можно было протестировать его в изоляции. Это требует проектирования (или рефакторинга) для внедрения зависимостей и более широкого применения подходов, повышающих гибкость кода: интерфейсов, полиморфизма, шаблонов проектирования, фреймворков для внедрения зависимостей, указателей на функции и прочих.

Таким образом, TDD способствует слабой связанности, простоте, гибкости конфигурирования, что является признаками хорошей архитектуры.

Перевод статьи осуществлён [Кротовым Артёмом](https://www.facebook.com/artem.v.krotov) и [Романом Лапаевым](https://www.linkedin.com/in/romanlapaev).
